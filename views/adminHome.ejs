<!DOCTYPE html>
<html ng-app="counter_configuration">
<script src= "http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
<style>

 th, td {
    border: 1px solid black;
}
</style>

<body>

<input type="button" ng-click="add_deals()" name="add_deals" value="add deals" />
<br><br>

<div  ng-controller="modifyCtrl">
Item Name <input type="text" ng-model="addmenu.item_name" >
Item Rating <input type="number" ng-model="addmenu.item_rating">
Item Price <input type="nunber" ng-model="addmenu.price" >

<input type="button" ng-click="add_item(addmenu)" value="+">


    <div class="wraper" >
    
                <table>
                    <thead>
                        <tr>
                            <th>Menu ID</th>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                    {{tabelsData}}
                        <tr ng-repeat="tableData in tabelsData">
                       {{tableData.item_name}}
                            <td>
                                <div ng-hide="editingData[tableData.menu_id]">{{tableData.menu_id | uppercase}}</div>
                                <div ng-show="editingData[tableData.menu_id]"><input type="text" ng-model="tableData.menu_id" /></div>
                            </td>
                            <td>
                                <div ng-hide="editingData[tableData.menu_id]">{{tableData.item_name | uppercase}}</div>
                                <div ng-show="editingData[tableData.menu_id]"><input type="text" ng-model="tableData.item_name" /></div>
                            </td>
                            <td>
                                <div ng-hide="editingData[tableData.menu_id]">{{tableData.price}}</div>
                                <div ng-show="editingData[tableData.menu_id]"><input type="text" ng-model="tableData.price" /></div>
                            </td>
                            
                            <td>
                                <button ng-hide="editingData[tableData.menu_id]" ng-click="modify(tableData)">Modify</button>
                                <button ng-show="editingData[tableData.menu_id]" ng-click="update(tableData)">Update</button>
                                
                                <button ng-hide="viewField">Remove</button>
                            </td>
                        </tr>
                       
                        <tr>
                        <td ng-hide="abc">{{results.item}}
                        <td ng-hide="abc">{{results.price}}
                         <td ng-hide="abc">
                                <button ng-hide="editingData[tableData.menu_id]" ng-click="modify(tableData)">Modify</button>
                                <button ng-show="editingData[tableData.menu_id]" ng-click="update(tableData)">Update</button>
                                
                                <button ng-hide="viewField">Remove</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
    
            </div>
    
    </div>
</div>

</div>
<script>
var app = angular.module('counter_configuration', []);






app.controller('modifyCtrl', ['$scope','$http', function($scope,$http){
    $scope.tabelsData= [];
   $scope.loadvalue= function()
    {
    $http({
    method:'GET',
    url:'/loadvalue'
    }).success(function(data){
   alert("dat a in anloadvalue"+JSON.parse(data.results));
    $scope.tabelsData=JSON.parse(data.results);
    alert("tabelsData : "+JSON.stringify($scope.tabelsData)); 
    });
    
    };
    $scope.loadvalue();
    $scope.editingData = {};
    //$scope.extra=true;
    for (var i = 0, length = $scope.tabelsData.length; i < length; i++) {
      $scope.editingData[$scope.tabelsData[i].menu_id] = false;
    }


    $scope.modify = function(tableData){
        $scope.editingData[tableData.menu_id] = true;
		

    };


    $scope.update = function(tableData){
      alert("tabledata item : "+tableData.item_name);
		$scope.editingData[tableData.menu_id] = false;
		  $http({
		            method: 'POST',
		            url: '/updateItem',
		            data:tableData
		            }).success(function(response){
		           		alert(JSON.stringify(response));
		           		//$scope.extra=false;
		           		$scope.results= response;
		        }).error(function(error){
		            alert("ERROR VIEWING PENDING CUSTOMER REQUEST");
		        });

    };
    
     $scope.abc=true;
    
    
    


    $scope.add_item = function(addmenu) {
    
		    	$http({
		            method: 'POST',
		            url: '/addItem',
		            data:addmenu
		            }).success(function(response){
		           		
		           		
		           		alert("angular : "+JSON.stringify(response));
		           		//$scope.abc=false;
		           		if(response==="OK"){
		           		window.location="/loadhome"; }
		           		//$scope.tabelsData=JSON.parse(data.results);
		        }).error(function(error){
		            alert("ERROR VIEWING PENDING CUSTOMER REQUEST");
		        });
		    };
    
    

}]);


</script> 

</body>
</html>
